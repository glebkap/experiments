# Алгоритм поиска дверей и окон на планах зданий

## Общее описание

Алгоритм предназначен для обнаружения, маркировки и подсчета дверей и окон на планах зданий с использованием методов компьютерного зрения. Алгоритм построен на основе комбинации методов шаблонного сопоставления и анализа контуров.

## Этапы алгоритма

### 1. Предварительная обработка входного изображения

- Загрузка изображения плана здания в формате JPG или PNG
- Преобразование в оттенки серого для упрощения последующей обработки
- Устранение шума с использованием Гауссова размытия
- Улучшение контрастности для более четкого выделения элементов
- Бинаризация изображения для выделения контуров

### 2. Подготовка эталонных образцов

- Загрузка и предобработка эталонных изображений дверей из директории `data/doors`
- Загрузка и предобработка эталонных изображений окон из директории `data/windows`
- Нормализация размеров и форматов эталонных изображений
- Извлечение ключевых характеристик эталонных объектов для последующего сравнения

### 3. Поиск объектов на изображении

#### Метод 1: Шаблонное сопоставление (Template Matching)

- Применение алгоритма `cv2.matchTemplate` для каждого эталонного образца
- Установка порога соответствия для фильтрации результатов
- Обработка пересекающихся обнаружений с помощью алгоритма подавления немаксимумов (NMS)

#### Метод 2: Поиск и анализ контуров

- Выделение контуров на бинаризованном изображении с помощью `cv2.findContours`
- Фильтрация контуров по размеру, форме и другим геометрическим характеристикам
- Анализ прямоугольности и соотношения сторон для классификации объектов
- Применение эвристик для идентификации дверей и окон:
  - Двери обычно имеют стандартные размеры и пропорции
  - Окна обычно располагаются в стенах и имеют характерные формы
  - Двери часто имеют дугу открывания

### 4. Постобработка и уточнение результатов

- Объединение результатов, полученных разными методами
- Устранение дублирующих обнаружений
- Проверка контекстной корректности (расположение относительно стен и других элементов)
- Применение дополнительных эвристик для повышения точности распознавания

### 5. Маркировка и классификация объектов

- Визуализация результатов на исходном изображении плана:
  - Обозначение дверей красным цветом
  - Обозначение окон синим цветом
- Присвоение уникальных идентификаторов каждому обнаруженному объекту
- Добавление меток с типом объекта (дверь/окно)

### 6. Формирование отчета

- Подсчет общего количества обнаруженных дверей
- Подсчет общего количества обнаруженных окон
- Сохранение размеченного изображения с выделенными объектами
- Вывод статистики по обнаруженным объектам

## Особенности реализации

- Использование библиотеки OpenCV для обработки изображений
- Реализация с учетом архитектурных принципов, описанных в документации проекта
- Разделение на доменные слои и usecase в соответствии с принятой структурой
- Учет требований по производительности (обработка одного изображения не более 10 секунд)
- Обеспечение точности распознавания не менее 90%
